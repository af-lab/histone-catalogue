\DoubleSpacing

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

\usepackage{kpfonts}

\usepackage[final]{graphicx}
\graphicspath{{./figs/}}

%% remove colorlinks when preparing for print
\usepackage[final,hyperindex,hyperfootnotes,bookmarksnumbered,colorlinks]{hyperref}

\usepackage{afterpage}
\usepackage{eqparbox}
%% keep size of first column of sequence align table on memory to calculate
%% the size limit for the second column
\newsavebox{\firstentrybox}
\newcolumntype{F}{%
  >{\begin{lrbox}{\firstentrybox}}%
    l%
  <{\end{lrbox}%
  \eqmakebox[firstentry][l]{\unhcopy\firstentrybox}}%
}

\newsubfloat{figure}

\usepackage{color}    % to color background of generated values values
\usepackage{seqsplit} % used in the output automatically generated by scripts
\usepackage{url}
\usepackage[textsize=footnotesize]{todonotes}
%% new command for box about missing references
\newcommand{\addref}[1][]{\todo[color=red!40,size=\tiny]{Add reference: #1}}

\usepackage[sectionbib,square,comma,numbers]{natbib}
\bibliographystyle{vancouver}

\usepackage{fp}
\usepackage{capt-of}

\usepackage[english]{isodate}

\newfloat{supplement}{sup}{Supplementary}
\setfloatlocations{supplement}{h}
\renewcommand{\thesupplement}{S\arabic{supplement}}

\input{results/variables-configuration.tex}
\input{results/variables-align_results}
\input{results/variables-cluster_stats}
\input{results/variables-protein_stats}
\input{results/variables-utr}
\input{results/variables-variants}
\input{results/variables-reference_comparison}
\input{data/variables-Marzluff-stats}

%% We define a style here which will be used around all the values that
%% are copmuted automatically.  The idea is to place them in a grey box
%% so that readers can really get the idea that the values in the text
%% are automatically generated.  To do that, the scripts will put the
%% values inside a ScriptValue macro which we define here to control how
%% it really looks.
\newcommand{\ScriptValue}[1]{\colorbox[gray]{0.8}{#1}}
%% But then, we also want to make operations with those values in LaTeX
%% using FPeval but FPeval fails because ScriptValue gets expanded into
%% something non-numeric.  So we use the following trick: we store the
%% original ScriptValue and FPeval macros, and then replace FPeval with
%% something that temporarily disables ScriptValue while we call the
%% original FPeval.  See http://tex.stackexchange.com/questions/159155
\let\RealScriptValue\ScriptValue

\let\RealFPeval\FPeval
\renewcommand{\FPeval}[2]{%
  \renewcommand{\ScriptValue}[1]{##1}%
  \RealFPeval{UnmarkedResult}{#2}%
  \renewcommand{\ScriptValue}{\RealScriptValue}%
  \expandafter\def\csname #1\endcsname{\ScriptValue{\UnmarkedResult}}%
}

\let\RealFPmin\FPmin
\renewcommand{\FPmin}[3]{%
  \renewcommand{\ScriptValue}[1]{##1}%
  \RealFPmin{\UnmarkedResult}{#2}{#3}%
  \renewcommand{\ScriptValue}{\RealScriptValue}%
  \expandafter\def\csname #1\endcsname{\ScriptValue{\UnmarkedResult}}%
}

\let\RealFPround\FPround
\renewcommand{\FPround}[3]{%
  \renewcommand{\ScriptValue}[1]{##1}%
  \RealFPround{\UnmarkedResult}{#2}{#3}%
  \renewcommand{\ScriptValue}{\RealScriptValue}%
  \expandafter\def\csname #1\endcsname{\ScriptValue{\UnmarkedResult}}%
}

\let\Realprintdate\printdate
\renewcommand{\printdate}[1]{%
  \renewcommand{\ScriptValue}[1]{##1}%
  \RealScriptValue{\Realprintdate{#1}}%
  \renewcommand{\ScriptValue}{\RealScriptValue}%
}


%%
%% Some computations fit better here in LaTeX than the scripts.
%%

%% Minimum overall PID of each histone type
\FPmin{result}{\HTwoAPID}{\HTwoBPID}
\FPmin{result}{\result}{\HThreePID}
\FPmin{HallMinPID}{\result}{\HFourPID}


\FPeval{result}{\SequenceChangeSinceReference{}
                + \PseudoSinceReference{}
                + \CodingSinceReference{}
                + \AddedSinceReference{}
                + \RemovedSinceReference{}}
\FPround{TotalChangesSinceReference}{\result}{0} % of course is an integer


\FPeval{PercentageGenesInHISTOne}{\CodingGenesInHISTOne{}*100/\TotalCodingGenes{}}


\FPeval{result}{\SequenceChangeSinceReference{}
                +\PseudoSinceReference{}
                +\CodingSinceReference{}}
\FPround{SequencesUpdatedSinceReference}{\result}{0} % of course is an integer
